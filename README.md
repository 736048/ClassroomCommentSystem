# CCS (Classroom Comment System)

授業やプレゼンテーションの場において、参加者の声をリアルタイムかつ視覚的に投影画面へ統合する、デスクトップ・オーバーレイ・アプリケーションです。
参加者がスマートフォンから送信したテキストが、スライドや資料の最前面に「蛍（ホタル）」のようにふわっと浮かび上がり、双方向的なコミュニケーションを演出します。

---

## 🚀 主な機能

### 1. インタラクティブ・オーバーレイ表示
*   **蛍（ホタル）方式アニメーション**: コメントは画面上のランダムな位置にフェードインで出現し、数秒間滞在した後、フェードアウトします。視線を大きく動かさずに内容を確認できる、独自性の高い視覚効果です。
*   **視認性の最適化**: 白文字には黒い縁取り、黒文字には白い縁取りを自動で適用。スライドの背景色に関わらず、常に高い可読性を維持します。
*   **マルチディスプレイ自動認識**: プロジェクター等の外部モニターが接続されている場合、自動的にそちらを優先してフルスクリーン表示を開始します。

### 2. 先生用「コックピット」管理パネル
*   **双方向編集パレット (編集キャンバス)**:
    *   画面比率を実際のスクリーンと完全に同期させたキャンバス上で、図形（丸、四角、直線）や「固定コメント」を直接マウスドラッグで配置・移動・変形できます。
    *   PowerPointのような直感的なリサイズハンドルを備え、強調したい箇所への注釈を瞬時に行えます。
*   **プレゼンテーション補助ツール**:
    *   **PowerPointノート同期 (macOS限定)**: スライドショーと連動し、現在のスライドの発表者ノートをリアルタイムで取得・表示します。
    *   **経過時間タイマー**: 発表開始からの時間を計測するストップウォッチ機能を搭載。
*   **高度なコメント制御**:
    *   文字サイズ（標準/大）、書体（ゴシック/明朝）、カラーバリエーションの指定。
    *   特定のコメントを画面上の任意の位置に永続表示させる「複数固定」機能。

### 3. スマートな運用支援
*   **動的ネットワーク設定**: アプリ起動後でも管理画面からポート番号を変更可能。変更時は接続中の全クライアントへ通知し、QRコードも即座に更新されます。
*   **巨大QRコード同期**: ボタン一つで管理画面と投影用画面の両方に巨大なQRコードを表示し、スムーズな参加を促します。
*   **NGワード・フィルタリング**: 約50単語のプリセットを含むフィルタリング機能を搭載。設定は `server/ng_words.json` に保存され、次回起動時も引き継がれます。

---

## 🛠 技術的な仕様

### アーキテクチャ
*   **Frontend**: Vanilla JavaScript + CSS Custom Properties (`clamp`, `aspect-ratio`, `grid`) によるレスポンシブかつスケーラブルなUI。
*   **Backend**: Node.js + Express によるWebサーバー。
*   **Communication**: Socket.io による双方向・低遅延イベント駆動型通信。
*   **Desktop Engine**: Electron 40.x をベースに、透明・最前面・マウスイベント透過などの高度なウィンドウ制御を実装。

### 主要な実装技術
*   **AppleScript Bridge**: メインプロセスから AppleScript を実行し、Microsoft PowerPoint のオブジェクトモデルへアクセス。スライドインデックスとノートテキストを抽出します。
*   **Responsive Typography**: `clamp()` 関数を用いたフォントサイズ自動調整により、あらゆる解像度のデバイスで一貫した操作性を確保。
*   **Dynamic SVG/CSS Shapes**: パーセンテージベースの座標管理により、操作端末（管理画面）と投影先（オーバーレイ）の解像度差異を吸収。

---

## 📦 セットアップ

### 必要要件
*   **Node.js**: v18以上推奨
*   **Microsoft PowerPoint**: (ノート同期機能を使用する場合)

### インストール
```bash
npm install
```

### 起動
```bash
npm start
```

## 📂 ファイル構成
*   `main.js`: Electronメインプロセス。ウィンドウ生成、ディスプレイ検出、AppleScript制御。
*   `server/app.js`: Socket.ioサーバー。コメントの中継、バリデーション、NGワード処理。
*   `renderer/`: 先生用・投影用のUIロジック（HTML/JS/CSS）。
*   `public/`: 生徒（参加者）用Webサイト。

---

## 📝 技術スタック
*   **Framework**: Electron
*   **Server**: Node.js / Express / Socket.io
*   **Utility**: QRCode.js / AppleScript
*   **Design**: Brutalist Style UI / Responsive Scaling

## ⚖️ ライセンス
ISC